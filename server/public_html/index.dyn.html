<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="/assets/style.css" rel="stylesheet">
</head>
<body>
    <h1>Hello, <?lu write(query.name or "Nomad") ?></h1>
    <h2>Welcome to 80's HTTP server!</h2>
    <img src="/assets/srgen.jpg">
    <p>w3.org response:</p>
    <pre><?lua
        header("X-Server-Time", os.time())
        if query.w3 then
            HTTP:GET("www.w3.org", "/", "text/html")(function(response)
                write(response)
                done()
            end)
        else
            write("w3 was not requested")
            done()
        end
    ?></pre>

    <h3>Users:</h3>
    <pre><?lua
        SQL:select("SELECT * FROM users")(function(users, err)
            if err then
                write("SQL error happened: " .. err)
            else
                for i, user in ipairs(users) do
                    write("Name: " .. user.name .. "\n")
                end
            end
            done()
        end)
    ?></pre>
</body>
</html>